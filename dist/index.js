var t=[],e=[];!function(i,n){if(i&&"undefined"!=typeof document){var s,o=!0===n.prepend?"prepend":"append",a=!0===n.singleTag,r="string"==typeof n.container?document.querySelector(n.container):document.getElementsByTagName("head")[0];if(a){var l=t.indexOf(r);-1===l&&(l=t.push(r)-1,e[l]={}),s=e[l]&&e[l][o]?e[l][o]:e[l][o]=p()}else s=p();65279===i.charCodeAt(0)&&(i=i.substring(1)),s.styleSheet?s.styleSheet.cssText+=i:s.appendChild(document.createTextNode(i))}function p(){var t=document.createElement("style");if(t.setAttribute("type","text/css"),n.attributes)for(var e=Object.keys(n.attributes),i=0;i<e.length;i++)t.setAttribute(e[i],n.attributes[e[i]]);var s="prepend"===o?"afterbegin":"beforeend";return r.insertAdjacentElement(s,t),t}}(".editor-js-quote-plugin {\n  display: grid;\n  gap: 16px;\n}\n.editor-js-quote-plugin__header {\n  display: flex;\n  align-items: stretch;\n  justify-content: stretch;\n  gap: 16px;\n}\n.editor-js-quote-plugin__image {\n  width: 100px;\n  height: 100px;\n  display: inline-flex;\n  flex-shrink: 0;\n  position: relative;\n}\n.editor-js-quote-plugin__image img {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n  object-position: center;\n  background: #f2f2f2;\n  border-radius: 5px;\n}\n.editor-js-quote-plugin__image button {\n  position: absolute;\n  right: 8px;\n  top: 8px;\n  width: 26px;\n  height: 26px;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  border: none;\n  background: #e9e9e9;\n  border-radius: 5px;\n  cursor: pointer;\n}\n.editor-js-quote-plugin__image button:hover {\n  background: #e2e2e2;\n}\n.editor-js-quote-plugin__image button svg {\n  width: 24px;\n  height: 24px;\n}\n.editor-js-quote-plugin__image-input {\n  position: relative;\n  width: 100px;\n  height: 100px;\n  border-radius: 5px;\n  border: 1px dashed #333;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  cursor: pointer;\n  flex-shrink: 0;\n  padding: 5px;\n  gap: 4px;\n  box-sizing: border-box;\n}\n.editor-js-quote-plugin__image-input input {\n  display: none;\n}\n.editor-js-quote-plugin__image-input svg {\n  width: 24px;\n  height: 24px;\n  margin: 0 auto;\n}\n.editor-js-quote-plugin__image-input span {\n  text-align: center;\n  color: #333;\n  font-size: 0.75em;\n}\n.editor-js-quote-plugin__author {\n  display: grid;\n  gap: 16px;\n  width: 100%;\n}\n",{});class i{rootClass="editor-js-quote-plugin";caption=null;text=null;image=null;post=null;headers={};uploadFileName="file";imageLoading=!1;endpoint="/";constructor({data:t,api:e,config:i}){this.caption=t.caption,this.post=t.post,this.text=t.text,this.image=t.image,this.api=e,i&&(i.headers&&(this.headers=i.headers),i.endpoint&&(this.endpoint=i.endpoint),i.uploadFileName&&(this.uploadFileName=i.uploadFileName))}render(){return this.root=document.createElement("div"),this.root.classList.add(this.rootClass),this.root.classList.add("cdx-block"),this.redraw(),this.root}async handleFileUpload(t){if(t.target.files[0]){let e=new FormData;return e.append(this.uploadFileName,t.target.files[0]),(await fetch(this.endpoint,{method:"POST",headers:this.headers,body:e}).then((t=>t.json()))).file}}redraw(){let t="";t=this.image?`<div class="${this.rootClass}__image">\n        <img src="${this.image}" alt="" />\n        <button type="button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 10.586l4.95-4.95 1.414 1.414-4.95 4.95 4.95 4.95-1.414 1.414-4.95-4.95-4.95 4.95-1.414-1.414 4.95-4.95-4.95-4.95L7.05 5.636z"/></svg></button>\n      </div>`:`<label class="${this.rootClass}__image-input ${this.imageLoading?"cdx-loader":""}">\n        <input type="file" accept="image/*" />\n        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/><path d="M4.828 21l-.02.02-.021-.02H2.992A.993.993 0 0 1 2 20.007V3.993A1 1 0 0 1 2.992 3h18.016c.548 0 .992.445.992.993v16.014a1 1 0 0 1-.992.993H4.828zM20 15V5H4v14L14 9l6 6zm0 2.828l-6-6L6.828 19H20v-1.172zM8 11a2 2 0 1 1 0-4 2 2 0 0 1 0 4z"/></svg>\n        <span>Загрузить изображение</span>\n      </label>`;let e=`<div class="${this.rootClass}__author">\n      <input type="text" class="cdx-input" value="${this.caption||""}" placeholder="Персона">\n      <input type="text" class="cdx-input" value="${this.post||""}" placeholder="Должность">\n    </div>`,i=`<div class="${this.rootClass}__header">${t}${e}</div>`;this.root.innerHTML=`${i}<textarea placeholder="Цитата" rows="5" class="cdx-input">${this.text||""}</textarea>`,this.api.listeners.on(this.root.querySelector(`.${this.rootClass}__author input:first-child`),"input",(t=>{this.caption=t.target.value}),!1),this.api.listeners.on(this.root.querySelector(`.${this.rootClass}__author input:last-child`),"input",(t=>{this.post=t.target.value}),!1),this.api.listeners.on(this.root.querySelector(`.${this.rootClass} textarea`),"input",(t=>{this.text=t.target.value}),!1),this.image?this.api.listeners.on(this.root.querySelector(`.${this.rootClass}__image button`),"click",(()=>{confirm("Вы уверены?")&&(this.image=null,this.redraw())}),!1):this.api.listeners.on(this.root.querySelector(`.${this.rootClass}__image-input input`),"input",(t=>{this.imageLoading=!0,this.handleFileUpload(t).then((t=>{this.image=t})).catch((t=>{console.error(t.message)})).finally((()=>{this.imageLoading=!1,this.redraw()}))}),!1)}save(){return{post:this.post,image:this.image,caption:this.caption,text:this.text}}static get toolbox(){return{title:"Цитата",icon:'<svg width="15" height="14" viewBox="0 0 15 14" xmlns="http://www.w3.org/2000/svg"><path d="M13.53 6.185l.027.025a1.109 1.109 0 0 1 0 1.568l-5.644 5.644a1.109 1.109 0 1 1-1.569-1.568l4.838-4.837L6.396 2.23A1.125 1.125 0 1 1 7.986.64l5.52 5.518.025.027zm-5.815 0l.026.025a1.109 1.109 0 0 1 0 1.568l-5.644 5.644a1.109 1.109 0 1 1-1.568-1.568l4.837-4.837L.58 2.23A1.125 1.125 0 0 1 2.171.64L7.69 6.158l.025.027z"></path></svg>'}}}export{i as default};
//# sourceMappingURL=index.js.map
